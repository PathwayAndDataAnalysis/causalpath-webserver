
<Title:>

    CausalPath


<Head:>

    <meta name="viewport" content="width=device-width">
    
    <link href="./build/bundle.css" rel="stylesheet">

    <!--<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/jstree/3.3.5/themes/default/style.min.css" />-->
    <link href="./lib/css/themes/default/style.css" rel="stylesheet">
    <link href="./lib/css/jquery-ui.css" rel="stylesheet">
    <link href="./lib/css/jquery-ui.css" rel="stylesheet">
    <link href="./lib/css/bootstrap.css" rel="stylesheet">

<Body:>

    <script src="./lib/js/jquery-3.4.0.js"></script>
    <script src="./lib/js/bootstrap.bundle.min.js"></script>
    <!--<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>-->


    <!--<script src="//cdnjs.cloudflare.com/ajax/libs/jstree/3.3.5/jstree.min.js"></script>-->
    <script src="./lib/js/jstree.min.js"></script>
    <!--For canvas-tab resizable-->
    <script src="./lib/js/jquery-ui.js"></script>


    <div id = "banner" class = "custom-header">
        <img src="logo.png"  class = "cp-logo"> &nbsp; &nbsp; &nbsp;&nbsp;
        CausalPath: Causal Interactions from Proteomic Profiles
    </div>


    <div id = "info-div">

        CausalPath generates explanations to the observations in proteomic data using literature-curated mechanistic pathways.
        Please refer to <a href="https://www.biorxiv.org/content/early/2018/02/02/258855">this preprint</a> for a description of the method.
        <p></p>
        A <a href="https://github.com/PathwayAndDataAnalysis/causalpath">Java implementation</a> of CausalPath is freely available.
        We also provide this web service for easy access to the method and/or visualizing analysis results.
        Please note the webserver does not support network significance calculations in the analysis due to limited resources.
        If that is desired, then the method needs to be run locally from its JAR file (see above link). Analysis results, however, can still be visualized on this webserver using option C below.
        <p></p>
        For a CausalPath analysis, please prepare your input files according to the <a href="https://github.com/PathwayAndDataAnalysis/causalpath/blob/master/wiki/InputFormat.md">guidelines</a>.
        If you already have results, please visualize them by uploading the related output folder(s) using option C below.
        A sample dataset and analysis parameters can be found in <a href="https://github.com/PathwayAndDataAnalysis/causalpath/raw/master/wiki/sample-data-and-parameters.zip">this archive</a>.
        This can be directly uploaded for analysis through option B below.
        <p></p>
        The <a href="https://github.com/PathwayAndDataAnalysis/causalpath-webserver">source code of this web server</a> is freely available in a separate project.
        <p></p>
        Select one of the following options to start.
    </div>
    <div id  = "graph-options-container">
        <table align= "top" cellpadding="10px" >
            <tbody>
            <tr align = "center">
                <td>
                    <label for="back-button">
                    <i class="fa fa-arrow-circle-left"></i> Back
                    </label>

                    <div> <input type="button" id = "back-button" display = "none" value = "Back" on-click = "showInputContainer()"> </div>

                </td>

                <td class = "graph-options-td">
                    <div data-tippy-placement="right" data-tippy="Groups the nodes that have the same graph topology, under a compound node. Use this feature for complexity management.">
                    <input type="checkbox" id = "sif-topology-grouping" checked = "{{!_page.doc.noTopologyGrouping}}" on-change = "reloadGraph()">
                     Topology grouping
                    </div>
                </td>

                <td class = "dropdown">

                    <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Layout
                    </button>

                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                        <button class = "dropdown-item" id="run-layout"  on-click = "runLayout()">Run Layout</button>
                        <button class = "dropdown-item" id="layout-properties" onclick = "document.getElementById('layout-properties-table').style.display='block'">Layout Properties...</button>
                    </div>

                </td>

                <td class = "graph-options-td">
                    <label for="show-legend-button">
                        <i class="fa fa-info-circle"></i> Show legend
                    </label>
                    <input type="button" id = "show-legend-button" value = "Graph legend" onclick = "document.getElementById('graph-legend').style.display='block'">
                </td>

                <td>
                    <div id = "download-div">
                        <label for="download-button">
                            <i class="fa fa-download"></i> Download Input & Analysis Results
                        </label>
                        <div> <input type="button" id = "download-button"  value = "Download" on-click = "downloadResults()"> </div>
                    </div>
                </td>


            </tr>
            </tbody>
        </table>
    </div>

    <div id= "input-container">

            <table  class = "main-input-content" border="0"  width="100%" align="center" >
                <tbody>

                <tr>
                    <td>
                        <div data-tippy="Type-in the parameters">
                            <label for="parameters-button">
                                <div class = 'input-label'>
                                    A. Load data and enter parameters for analysis <i class="fa fa-tasks"></i> </div></label>
                            <input  type = "button" id = "parameters-button" onclick = "document.getElementById('parameters-table').style.display='block'">
                        </div>
                    </td>
                </tr>
                <tr>
                    <!--<td>-->
                        <!--B. Upload input files for analysis:-->
                        <!--</div>-->
                    <!--</td>-->
                    <td>
                        <div data-tippy="Enter multiple input files (data and parameters.txt files at the minimum) or a zip file of input files" >
                        <label for="analysis-directory-input">
                            <div class = 'input-label' > B. Upload all input files for analysis <i class="fa fa-upload"></i></div>
                        </label>
                        <input type="file"  id="analysis-directory-input" accept=".txt, .zip" on-change = "loadAnalysisDirFromServer($event)" multiple >
                        </div>
                    </td>

                </tr>

                <tr align="left">

                    <!--<td>-->
                    <!--A. Upload json file for visualization:-->
                    <!--</td>-->
                    <td>
                        <div data-tippy="Load an analysis folder or a hierarchy of folders">
                            <label for="graph-file-input">
                                <div class = 'input-label'> C. Visualize results from previous analysis  <i class="fa fa-upload"></i> </div>
                            </label>
                            <!--<input type="file" id="graph-file-input" accept=".txt, .json" on-change = "loadGraphFile($event)">-->
                            <input type="file" id="graph-file-input" on-change = "loadAnalysisDirFromClient($event)" webkitdirectory directory multiple>

                        </div>
                    </td>

                </tr>

                <tr>

                    <td>
                        <div data-tippy="A sample result network for Immunoreactive subtype of ovarian cancer compared to other subtypes">
                        <label for="demo-file-button">
                            <div class = 'input-label'> D. Display a sample result <i class="fa fa-play">  </i></div>
                        </label>
                        <input type="button" id="demo-file-button"  value = "Display" on-click = "loadDemoGraph()"  >
                        </div>
                    </td>
                </tr>

                </tbody>

            </table>
        </div>

    <div id="graph-legend" class="w3-modal">
        <div class="w3-modal-content">
            <!--<header class="w3-container">-->
                <!--<div class = "modal-body">-->
            <!--<div class = "legend-container">-->
            <span onclick="document.getElementById('graph-legend').style.display='none'" class="w3-button w3-display-topright close-button">&times;</span>
            <img src='img/legend.png'/>
                <!--</div>-->
            <!--</div>-->
                <!--<h2>Graph legend</h2>-->
            <!--</header>-->
        </div>
    </div>


    <div id="parameters-table" class="w3-modal">
        <div class="w3-modal-content">
            <div class="w3-modal-container parameters">
            <header class="w3-container custom-header"> <span onclick="document.getElementById('parameters-table').style.display='none'" class="w3-button w3-display-topright close-button">&times;</span>
                <h2>Parameters</h2> </header>
                <p></p>
                <table class = "parameter-content"><tbody>
                    {{each _page.doc.parameters as #parameter,  #i}}

                            {{each #parameter.cnt as #cnt}} <!--multiple number of the same parameter-->
                                {{if #parameter.isVisible === true}}
                                        <!--<span style = "display:{{#parameter.display}}; width:200px ;margin:5px;">-->

                                    <!--{{else}}-->
                                        <!--<span style = "display: none">-->
                                <tr>
                                <td data-tippy-placement="right" data-tippy={{#parameter.Description}}>
                                    {{if #parameter.Mandatory }}
                                    {{#parameter.Title}} <span style ="color:red" >*</span>:
                                    {{else}}
                                    {{#parameter.Title}}:
                                    {{/if}}
                                </td>

                                {{each #parameter.EntryType as #type,  #entryInd}}
                                    <td>
                                        {{if  #type === 'File'}}
                                            <label for= {{#parameter.domId[#cnt][#entryInd]}} class = "fa fa-file-text-o parameters-input"> Select {{#parameter.value[#cnt][#entryInd]}} </label>
                                            <input type="file" id= {{#parameter.domId[#cnt][#entryInd]}} accept=".txt" on-change = "loadFile($event, #parameter, #cnt, #entryInd)">
                                        {{else if #type === 'Double'}}
                                            <input class = "parameters-input" id = {{#parameter.domId[#cnt][#entryInd]}}  type = 'number' value = {{#parameter.value[#cnt][#entryInd]}}  step = 0.01 >

                                        {{else if #type === 'Integer'}}
                                            <input class = "parameters-input" id = {{#parameter.domId[#cnt][#entryInd]}} type = 'number' value = {{#parameter.value[#cnt][#entryInd]}} step = 1 >

                                        {{else if #type === 'String'}}
                                            <input class = "parameters-input" id = {{#parameter.domId[#cnt][#entryInd]}} type = 'text' value = {{#parameter.value[#cnt][#entryInd]}}  >

                                        {{else if #type === 'Boolean'}}
                                            <input class = "parameters-input" id = {{#parameter.domId[#cnt][#entryInd]}} type = 'checkbox' on-click = "updateChecked(#parameter, #cnt, #entryInd)">

                                        {{else}}
                                            <select id =  {{#parameter.domId[#cnt][#entryInd]}} class = "parameters-select" on-change = "updateSelected(#parameter, #cnt, #entryInd)" on-click = "unselectParameter(#parameter, #cnt , #entryInd)">
                                            {{each getEnum(#type) as #option}}
                                                <option name = {{#option}}>{{#option}}</option>
                                             {{/each}}
                                            </select>


                                        {{/if}}


                                        <!--{{if #parameter.CanBeMultiple && #entryInd === #parameter.EntryType.length-1 && #cnt === 0}}-->
                                        <!--<img src='img/add.png' on-click = "addParameterInput(#parameter)"/>-->
                                        <!--{{/if}}-->

                                    </td>



                                    {{if #parameter.CanBeMultiple && #entryInd === #parameter.EntryType.length-1 && #cnt === 0}}
                                    <td >
                                        <table class = "inner-table"> <tbody>
                                            <tr>
                                            <td>
                                            <img src='img/add.png' on-click = "addParameterInput(#parameter)"/>
                                            </td>
                                            <td>
                                            <button  on-click = "updateBatchBox(#parameter)" onclick = "document.getElementById('{{#parameter.batchModalDomId}}').style.display='block'">Batch</button>
                                            </td></tr>
                                        </tbody></table>

                                            <div id=  {{#parameter.batchModalDomId}}  class="w3-modal">
                                                <div class="w3-modal-content">
                                                    <div class="w3-modal-container parameters">
                                                        <header class="w3-container "> <span onclick="document.getElementById('{{#parameter.batchModalDomId}}').style.display='none'" class="w3-button w3-display-topright close-button">&times;</span>
                                                        *Separate multiple columns by space</header>
                                                        <p></p>

                                                        <textarea id =  {{#parameter.batchDomId}} rows = "30" cols = "100"></textarea>

                                                        <p></p>
                                                        <button on-click = "updateBatch(#parameter, #cnt)" onclick="document.getElementById('{{#parameter.batchModalDomId}}').style.display='none'">Submit</button>

                                                    </div>
                                                </div>
                                            </div>
                                        </td>

                                    {{/if}}
                                {{/each}} <!--each entrytype-->

                                </tr>

                                <!--</span>-->
                    {{/if}} <!--isVisible-->
                            {{/each}} <!--each cnt-->

                    {{/each}} <!--each parameter-->
                </tbody></table>
                <table><tbody>
                    <tr>
                        <td><input type = "button" value = "Reset to default values" on-click = "resetToDefaultParameters()"></td>
                        <td><input type = "button" value = "Submit" on-click = "submitParameters()"></td>
                    </tr>
                </tbody></table>
            </div>
        </div>
    </div>


    <div id="layout-properties-table" class="w3-modal">
        <div class="w3-modal-content">
        <div class="w3-modal-container parameters">
            <header class="w3-container custom-header"> <span onclick="document.getElementById('layout-properties-table').style.display='none'" class="w3-button w3-display-topright close-button">&times;</span>
                <h2>Layout Properties</h2> </header>
            <p></p>
            <table class = "parameter-content">
                <tbody>
                <tr>
                    <td>
                        <input id="node-repulsion" type="text" min="0" class="sbgn-input-small layout-text integer-input" value = {{_page.doc.layout.nodeRepulsion}} >
                    </td>
                </tr>

                <tr>
                    <td>
                        <span class="add-on layout-text" title="Ideal (intra-graph) edge length"> Ideal Edge Length </span>
                    </td>
                    <td>
                        <input id="ideal-edge-length" type="number" min="5" class="sbgn-input-small layout-text integer-input" value = {{_page.doc.layout.idealEdgeLength}} >
                    </td>
                </tr>

                <tr>
                    <td>
                        <span class="add-on layout-text" title="Divisor to compute edge forces"> Edge Elasticity </span>
                    </td>
                    <td>
                        <input id="edge-elasticity" type="number" min="0" class="sbgn-input-small layout-text" value = {{_page.doc.layout.edgeElasticity}} >
                    </td>
                </tr>

                <tr>
                    <td>
                        <span class="add-on layout-text" title="Nesting factor (multiplier) to compute ideal edge length for inter-graph edges"> Nesting Factor </span>
                    </td>
                    <td>
                        <input id="nesting-factor" type="number" min="0" class="sbgn-input-small layout-text" value = {{_page.doc.layout.nestingFactor}} >
                    </td>
                </tr>

                <tr>
                    <td>
                        <span class="add-on layout-text" title="Gravity force (constant)"> Gravity </span>
                    </td>
                    <td>
                        <input id="gravity" type="number" min="0" class="sbgn-input-small layout-text" value = {{_page.doc.layout.gravity}} >
                    </td>
                </tr>

                <tr>
                    <td>
                        <span class="add-on layout-text" title="Gravity range (constant)"> Gravity Range   </span>
                    </td>
                    <td>
                        <input id="gravity-range" type="number" min="0" class="sbgn-input-small layout-text" value = {{_page.doc.layout.gravityRange}} >
                    </td>
                </tr>

                <tr>
                    <td>
                        <span class="add-on layout-text" title="Gravity force (constant) for compounds"> Compound Gravity  </span>
                    </td>
                    <td>
                        <input id="gravity-compound" type="number" min="0" class="sbgn-input-small layout-text" value = {{_page.doc.layout.gravityCompound}} >
                    </td>
                </tr>

                <tr>
                    <td>
                        <span class="add-on layout-text" title="Gravity range (constant) for compounds"> Compound Gravity Range </span>
                    </td>
                    <td>
                        <input id="gravity-range-compound" type="number" min="0" class="sbgn-input-small layout-text" value = {{_page.doc.layout.gravityRangeCompound}} >
                    </td>
                </tr>

                <tr>
                    <td>
                        <span class="add-on layout-text" title="Maximum number of iterations to perform"> Number of Iterations </span>
                    </td>
                    <td>
                        <input id="num-iter" type="number" min="0" class="sbgn-input-small layout-text integer-input" value = {{_page.doc.layout.numIter}} >
                    </td>
                </tr>

                <tr>
                    <td>
                        <span class="add-on layout-text" title="Amount of vertical space to put between degree zero nodes during tiling"> Tiling Vertical Padding </span>
                    </td>
                    <td>
                        <input id="tiling-padding-vertical" type="number" min="0" class="sbgn-input-small layout-text integer-input" value = {{_page.doc.layout.tilingPaddingVertical}} >
                    </td>
                </tr>

                <tr>
                    <td>
                        <span class="add-on layout-text" title="Amount of horizontal space to put between degree zero nodes during tiling"> Tiling Horizontal Padding </span>
                    </td>
                    <td>
                        <input id="tiling-padding-horizontal" type="number" min="0" class="sbgn-input-small layout-text integer-input" value = {{_page.doc.layout.tilingPaddingHorizontal}} >
                    </td>
                </tr>

                <tr>
                    <td>
                        <span class="add-on layout-text" title="Whether to tile disconnected nodes" > Tile Disconnected </span>
                    </td>

                    <td>
                        <input id="tile" type="checkbox" class="layout-text" checked = {{_page.doc.layout.tileDisconnected}}>
                    </td>
                </tr>

                <tr>
                    <td>
                        <span class="add-on layout-text" title="Whether to perform animation during layout" > Animate </span>
                    </td>

                    <td>
                        <input id="animate" type="checkbox" class="layout-text" checked = {{_page.doc.layout.animate}}>
                    </td>
                </tr>
                <tr>
                    <td>
                        <span class="add-on layout-text" title="Whether to enable incremental mode" > Incremental </span>
                    </td>

                    <td>
                        <input id="incremental" type="checkbox" class="layout-text" checked = {{_page.doc.layout.incremental}}>
                    </td>
                </tr>

                <tr>
                    <td>
                        <span class="add-on layout-text" title="Initial cooling factor for incremental layout"> Incremental Cooling Factor </span>
                    </td>
                    <td>
                        <input id="incremental-cooling-factor" type="number" min="0" class="sbgn-input-small layout-text" value = {{_page.doc.layout.initialEnergyOnIncremental}} >
                    </td>
                </tr>

                <tr>
                    <td>
                        <span class="add-on layout-text" title="Whether to adjust port orientations to improve flow" > Improve Flow </span>
                    </td>
                    <td>
                        <input id="improve-flow" type="checkbox" class="layout-text" checked = {{_page.doc.layout.improveFlow}}>
                    </td>
                </tr>
                </tbody>
            </table>

            <input type = "button" value = "OK" on-click = "submitLayoutParameters()">

            <input type = "button" value = "Default" on-click = "resetToDefaultLayoutParameters()">

        </div>
        </div>
    </div>



    <div id = "folder-tree"></div>
    <div id = "graph-container"></div>
